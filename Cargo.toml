[package]
name = "terrarium"
version = "0.1.0"
edition = "2021"

authors = ["Philipp Marmet  <fujexo@c0d3.ch>"]
description = "Binary package for controlling various components of a *arium"
readme = "README.md"
repository = "https://github.com/fujexo/rs-terrarium"
license-file = "LICENSE.txt"
keywords = [""]
categories = [""]

[dependencies]
openweathermap = "0.2.4"
chrono = "0.4.22"
chrono-tz = "0.8.0"
iso8601-duration = "0.1.0"
config = "0.13.2"
serde = "1.0.150"
serde_derive = "1.0.137"
serde_json = "1.0.89"
log = "0.4.17"
env_logger = "0.10.0"
rppal = "0.14.1"
ingics = { version = "0.1.1", features=["influxdb"] }
futures = "0.3"
bluer = { version = "0.15.4", features = ["full"] }
tokio = { version = "1", features = ["full"] }
influxdb = "0.5.2"
clap = { version = "4.0.29", features = ["derive"] }

[dev-dependencies]
mockall = "0.11.3"
cargo-deb = "1.41.3"

[package.metadata.cross.build]
default-target = "armv7-unknown-linux-gnueabihf"
pre-build = ["dpkg --add-architecture armhf", "apt-get update && apt-get install --assume-yes libdbus-1-dev libdbus-1-dev:armhf pkg-config"]

[package.metadata.cross.build.env]
passthrough = [
  "RUSTFLAGS",
]

[package.metadata.deb]
depends = "dbus, influxdb, grafana"
assets  = [
  ["target/release/terrarium", "/usr/bin/terrarium", "775"],
  ["assets/terrarium.service", "/lib/systemd/system/terrarium.service", "755"],
  ["assets/grafana/influxdb.yaml", "/etc/grafana/provision/datasources/influxdb.yaml", "755"],
  ["assets/grafana/terrarium.yaml", "/etc/grafana/provision/dashboards/terrarium.yaml", "755"],
  ["assets/grafana/terrarium.json", "/etc/grafana/dashboards/terrarium.json", "755"],
]
